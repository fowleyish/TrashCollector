@model TrashCollector.ViewModels.EmployeeDashboardViewModel

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 style="display:none">Index</h1>

<div>
    <h2 id="greeting">
        Hello,
        <span id="firstName">
            @Html.DisplayFor(x => x.Employee.FirstName)!
        </span>
    </h2>
    <div id="employeeId">
        Employee ID: @Html.DisplayFor(x => x.Employee.EmployeeId)
    </div>

    <hr />

    <div id="employeeDashboard">

        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <h5>View route for: </h5>
                    <form asp-action="ViewDaySchedule">
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="calIcon-1">
                                    <svg class="bi bi-calendar3" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z" />
                                        <path fill-rule="evenodd" d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
                                    </svg>
                                </span>
                            </div>
                            <input class="form-control" id="setDateRoute" name="SelectedDay" data-provide="datepicker" placeholder="Select a date" value="Today" type="text" aria-describedby="calIcon-1" />
                        </div>
                        <input type="submit" value="Go" class="btn btn-primary" />
                    </form>
                </div>
                <div id="stopsList">
                    @foreach (var stop in @Model.Stops)
                    {
                        <div class="card" onclick="initMap(@stop.Street, @stop.City, @stop.State, @stop.Zip)">
                            <div class="stopAddress">
                                @Html.DisplayFor(x => stop.Street)
                                @Html.DisplayFor(x => stop.City), @Html.DisplayFor(x => stop.State) @Html.DisplayFor(x => stop.Zip)
                            </div>
                            <div class="completeButton">
                                <a class="btn btn-primary" asp-action="CompleteStop" asp-route-id="@stop.PickupId">Complete</a>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <div class="col-md-8">
                <div id="map" style="width:100%; height:400px; background-color:gray;">
                    <div id="mapPlaceholderText">Interactive map coming soon!</div>
                </div>
                <script>
                    function initMap(street, city, state, zip) {
                        var address = `${street},${city}_${state}_${zip}`;
                        var map = new google.maps.Map(document.getElementById('map'), {
                            mapTypeId: google.maps.MapTypeId.ROADMAP,
                            zoom: 6
                        });
                        var geocoder = new google.maps.geocoder;
                        geocoder.geocode({
                            'address': address
                        },
                        function (results, status) {
                            if (status == google.maps.GeocoderStatus.OK) {
                                new google.maps.Marker({
                                    position: results[0].geometry.location,
                                    map: map
                                });
                                map.setCenter(results[0].geometry.location);
                            }
                        });
                    }
                </script>
            </div>


        </div>




















    </div>

</div>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker3.css" />
